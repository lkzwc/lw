{"version":3,"file":"add-skill.js","sources":["pages/skills/add-skill.vue","pages/skills/add-skill.vue?type=page"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<form @submit=\"submitSkill\">\n\t\t\t<!-- 技能标题 -->\n\t\t\t<view class=\"form-group\">\n\t\t\t\t<text class=\"label\">技能标题 *</text>\n\t\t\t\t<input \n\t\t\t\t\tclass=\"input\" \n\t\t\t\t\tv-model=\"skillData.title\" \n\t\t\t\t\tplaceholder=\"请输入技能标题\"\n\t\t\t\t\tmaxlength=\"50\"\n\t\t\t\t/>\n\t\t\t</view>\n\n\t\t\t<!-- 技能分类 -->\n\t\t\t<view class=\"form-group\">\n\t\t\t\t<text class=\"label\">技能分类 *</text>\n\t\t\t\t<picker \n\t\t\t\t\t:value=\"categoryIndex\" \n\t\t\t\t\t:range=\"categories\" \n\t\t\t\t\trange-key=\"name\"\n\t\t\t\t\t@change=\"onCategoryChange\"\n\t\t\t\t>\n\t\t\t\t\t<view class=\"picker\">\n\t\t\t\t\t\t{{ skillData.category || '请选择技能分类' }}\n\t\t\t\t\t</view>\n\t\t\t\t</picker>\n\t\t\t</view>\n\n\t\t\t<!-- 技能描述 -->\n\t\t\t<view class=\"form-group\">\n\t\t\t\t<text class=\"label\">技能描述 *</text>\n\t\t\t\t<textarea \n\t\t\t\t\tclass=\"textarea\" \n\t\t\t\t\tv-model=\"skillData.description\" \n\t\t\t\t\tplaceholder=\"请详细描述您的技能，包括技能水平、经验等\"\n\t\t\t\t\tmaxlength=\"500\"\n\t\t\t\t></textarea>\n\t\t\t</view>\n\n\t\t\t<!-- 技能图片 -->\n\t\t\t<view class=\"form-group\">\n\t\t\t\t<text class=\"label\">技能图片</text>\n\t\t\t\t<ImageUploader \n\t\t\t\t\tv-model=\"skillData.images\"\n\t\t\t\t\t:max-count=\"6\"\n\t\t\t\t\tmodule=\"skills\"\n\t\t\t\t\t@upload-success=\"onUploadSuccess\"\n\t\t\t\t\t@upload-error=\"onUploadError\"\n\t\t\t\t/>\n\t\t\t</view>\n\n\t\t\t<!-- 联系方式 -->\n\t\t\t<view class=\"form-group\">\n\t\t\t\t<text class=\"label\">联系方式 *</text>\n\t\t\t\t<input \n\t\t\t\t\tclass=\"input\" \n\t\t\t\t\tv-model=\"skillData.contact\" \n\t\t\t\t\tplaceholder=\"请输入微信号、QQ号或手机号\"\n\t\t\t\t\tmaxlength=\"50\"\n\t\t\t\t/>\n\t\t\t</view>\n\n\t\t\t<!-- 价格范围 -->\n\t\t\t<view class=\"form-group\">\n\t\t\t\t<text class=\"label\">价格范围</text>\n\t\t\t\t<input \n\t\t\t\t\tclass=\"input\" \n\t\t\t\t\tv-model=\"skillData.price\" \n\t\t\t\t\tplaceholder=\"如：50-100元/小时，面议等\"\n\t\t\t\t\tmaxlength=\"30\"\n\t\t\t\t/>\n\t\t\t</view>\n\n\t\t\t<!-- 可服务时间 -->\n\t\t\t<view class=\"form-group\">\n\t\t\t\t<text class=\"label\">可服务时间</text>\n\t\t\t\t<textarea \n\t\t\t\t\tclass=\"textarea\" \n\t\t\t\t\tv-model=\"skillData.availableTime\" \n\t\t\t\t\tplaceholder=\"请描述您的可服务时间，如：周末、工作日晚上等\"\n\t\t\t\t\tmaxlength=\"200\"\n\t\t\t\t></textarea>\n\t\t\t</view>\n\n\t\t\t<!-- 提交按钮 -->\n\t\t\t<button \n\t\t\t\tclass=\"submit-btn\" \n\t\t\t\t:disabled=\"isSubmitting\"\n\t\t\t\t@tap=\"submitSkill\"\n\t\t\t>\n\t\t\t\t{{ isSubmitting ? '发布中...' : '发布技能' }}\n\t\t\t</button>\n\t\t</form>\n\t</view>\n</template>\n\n<script setup>\n\timport { ref, reactive } from 'vue';\n\timport { onLoad } from '@dcloudio/uni-app';\n\timport ImageUploader from '@/components/ImageUploader.vue';\n\n\t// 响应式数据\n\tconst skillData = reactive({\n\t\ttitle: '',\n\t\tcategory: '',\n\t\tdescription: '',\n\t\timages: [],\n\t\tcontact: '',\n\t\tprice: '',\n\t\tavailableTime: ''\n\t});\n\n\tconst isSubmitting = ref(false);\n\tconst categoryIndex = ref(0);\n\n\t// 技能分类\n\tconst categories = ref([\n\t\t{ name: '编程开发', value: 'programming' },\n\t\t{ name: '设计创意', value: 'design' },\n\t\t{ name: '语言翻译', value: 'language' },\n\t\t{ name: '音乐艺术', value: 'music' },\n\t\t{ name: '体育健身', value: 'sports' },\n\t\t{ name: '学习辅导', value: 'education' },\n\t\t{ name: '生活服务', value: 'life' },\n\t\t{ name: '其他技能', value: 'other' }\n\t]);\n\n\t// 云对象实例\n\tlet skillsObj = null;\n\n\t// 初始化云对象\n\tconst initCloudObj = () => {\n\t\ttry {\n\t\t\tskillsObj = uniCloud.importObject('skills');\n\t\t} catch (error) {\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '服务初始化失败',\n\t\t\t\ticon: 'none'\n\t\t\t});\n\t\t}\n\t};\n\n\t// 分类选择\n\tconst onCategoryChange = (e) => {\n\t\tcategoryIndex.value = e.detail.value;\n\t\tskillData.category = categories.value[e.detail.value].name;\n\t};\n\n\t// 图片上传成功回调\n\tconst onUploadSuccess = (data) => {\n\t\t// 图片上传成功，ImageUploader组件会自动更新skillData.images\n\t};\n\n\t// 图片上传失败回调\n\tconst onUploadError = (error) => {\n\t\t// 图片上传失败处理\n\t};\n\n\t// 表单验证\n\tconst validateForm = () => {\n\t\tif (!skillData.title.trim()) {\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '请输入技能标题',\n\t\t\t\ticon: 'none'\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!skillData.category) {\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '请选择技能分类',\n\t\t\t\ticon: 'none'\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!skillData.description.trim()) {\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '请输入技能描述',\n\t\t\t\ticon: 'none'\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!skillData.contact.trim()) {\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '请输入联系方式',\n\t\t\t\ticon: 'none'\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t};\n\n\t// 提交技能\n\tconst submitSkill = async () => {\n\t\tif (!validateForm()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (isSubmitting.value) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!skillsObj) {\n\t\t\tinitCloudObj();\n\t\t\tif (!skillsObj) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '服务不可用，请重试',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tisSubmitting.value = true;\n\n\t\t\t// 准备提交数据\n\t\t\tconst submitData = {\n\t\t\t\ttitle: skillData.title.trim(),\n\t\t\t\tcategory: skillData.category,\n\t\t\t\tdescription: skillData.description.trim(),\n\t\t\t\timages: skillData.images,\n\t\t\t\tcontact: skillData.contact.trim(),\n\t\t\t\tprice: skillData.price.trim(),\n\t\t\t\tavailableTime: skillData.availableTime.trim()\n\t\t\t};\n\n\t\t\t// 调用云对象提交技能\n\t\t\tconst result = await skillsObj.addSkill(submitData);\n\n\t\t\tif (result.errCode === 0) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '技能发布成功',\n\t\t\t\t\ticon: 'success'\n\t\t\t\t});\n\n\t\t\t\t// 返回上一页\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tuni.navigateBack();\n\t\t\t\t}, 1500);\n\t\t\t} else {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: result.errMsg || '发布失败',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t});\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '网络错误，请重试',\n\t\t\t\ticon: 'none'\n\t\t\t});\n\t\t} finally {\n\t\t\tisSubmitting.value = false;\n\t\t}\n\t};\n\n\tonLoad(() => {\n\t\tinitCloudObj();\n\t});\n</script>\n\n<style scoped>\n\t.container {\n\t\tpadding: 30rpx;\n\t\tbackground: #f8f9fa;\n\t\tmin-height: 100vh;\n\t}\n\n\t.form-group {\n\t\tbackground: white;\n\t\tborder-radius: 16rpx;\n\t\tpadding: 30rpx;\n\t\tmargin-bottom: 20rpx;\n\t\tbox-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.06);\n\t}\n\n\t.label {\n\t\tdisplay: block;\n\t\tfont-size: 28rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #333;\n\t\tmargin-bottom: 20rpx;\n\t}\n\n\t.input, .textarea, .picker {\n\t\twidth: 100%;\n\t\tpadding: 20rpx;\n\t\tborder: 1rpx solid #e5e5e5;\n\t\tborder-radius: 12rpx;\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t\tbackground: #fafafa;\n\t}\n\n\t.textarea {\n\t\theight: 200rpx;\n\t\tresize: none;\n\t}\n\n\t.picker {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\theight: 80rpx;\n\t\tcolor: #666;\n\t}\n\n\t.submit-btn {\n\t\twidth: 100%;\n\t\theight: 88rpx;\n\t\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 16rpx;\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t\tmargin-top: 40rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t.submit-btn:disabled {\n\t\topacity: 0.6;\n\t}\n\n\t.submit-btn:active:not(:disabled) {\n\t\ttransform: scale(0.98);\n\t}\n</style>","import MiniProgramPage from '/Users/zwc/Documents/HBuilderProjects/hxzyL/pages/skills/add-skill.vue'\nwx.createPage(MiniProgramPage)"],"names":["reactive","ref","uniCloud","uni","onLoad"],"mappings":"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"}